<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>จัดการโครงงาน — ระบบจัดการโครงงาน</title>
    <link rel="icon" href="./imgs/kmutnb_index_Logo.png" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
    <link rel="stylesheet" href="./css/styles.css" />
    <script src="https://kit.fontawesome.com/ca7b0a986d.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="app">
        <!-- ===== Left Sidebar ===== -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="app-icon">
                    <img src="./imgs/logo-it.jpg" alt="โลโก้ ภาควิชา" width="60" height="60" style="border-radius: 50%;" />
                </div>
                <div class="app-meta">
                    <div class="app-name">ระบบจัดการโครงงาน</div>
                    <div class="app-ver">ภาควิชาเทคโนโลยีสารสนเทศ</div>
                    <div class="app-ver">เวอร์ชัน 1.0</div>
                </div>
            </div>
            <nav class="side-nav">
                <a class="side-link" href="dashboard.html"><span><i class="fa-solid fa-grip"></i></span>แดชบอร์ด</a>
                <a class="side-link active" href="project-management.html"><span><i class="fa-solid fa-table"></i></span>จัดการโครงงาน</a>
                <a class="side-link" href="student-management.html"><span><i class="fa-solid fa-user-gear"></i></span>นักศึกษา</a>
                <a class="side-link" href="advisor.html"><span><i class="fa-solid fa-user-tie"></i></span>อาจารย์ที่ปรึกษา</a>
                <a class="side-link" href="organization.html"><span><i class="fa-solid fa-building"></i></span>องค์กรสหกิจ</a>
                <a class="side-link" href="report.html"><span><i class="fa-solid fa-file"></i></span>รายงาน</a>
                <a class="side-link" href="statistics.html"><span><i class="fa-solid fa-chart-simple"></i></span>สถิติ</a>
                <a class="side-link" href="settings.html"><span><i class="fa-solid fa-gear"></i></span>การตั้งค่า</a>
            </nav>
            <!-- Contact to admin -->
            <div class="contact-container">
                <img src="./imgs/maintain.png" alt="รูปการติดต่อ" width="80" />
                <h6>กรณีที่พบปัญหาการใช้งาน</h6>
                <div class="contact">
                    <p>ติดต่อได้ที่ 02-555-2000</p>
                    <p>กลุ่มงานทะเบียนฯ ต่อ 1628-1635</p>
                    <p>บัณฑิตวิทยาลัย ต่อ 2406, 2413 - 2415</p>
                </div>
            </div>
        </aside>

        <!-- ===== Content Area ===== -->
        <div class="main-content">
            <nav class="top-bar">
                <div class="logo">
                    <img src="./imgs/kmutnb_index_Logo.png" alt="โลโก้มหาวิทยาลัย" width="40" height="40" style="border-radius: 50%;" />
                    <div class="text">
                        <p>มหาวิทยาลัยเทคโนโลยีพระจอมเกล้าพระนครเหนือ</p>
                        <p>KING MONGKUT'S UNIVERSITY OF TECHNOLOGY NORTH BANGKOK</p>
                    </div>
                </div>
                <div class="button-container ms-auto">
                    <a href="index.html">
                        <button class="btn" style="background-color: #f77100; border-radius: 10px; color: white;">ออกจากระบบ</button>
                    </a>
                </div>
            </nav>

            <!-- ===== Body Section ===== -->
            <section class="body-section">
                <div class="container-fluid px-0">
                    <!-- Header Section -->
                    <div class="row align-items-center mb-4">
                        <div class="col">
                            <h2 class="fw-bold mb-1">จัดการโครงงาน</h2>
                            <div class="text-muted">ระบบติดตามโครงงานพิเศษและสหกิจศึกษา ภาควิชาเทคโนโลยีสารสนเทศ</div>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProjectModal">
                                <i class="fa-solid fa-plus me-2"></i>เพิ่มโครงงานใหม่
                            </button>
                        </div>
                    </div>

                    <!-- Filter Section -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-md-4">
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="fa-solid fa-magnifying-glass"></i></span>
                                                <input type="text" class="form-control" placeholder="ค้นหาโครงงาน, นักศึกษา หรือหัวข้อ..." id="searchInput">
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <select class="form-select" id="statusFilter">
                                                <option value="">สถานะทั้งหมด</option>
                                                <option value="proposed">เสนอหัวข้อ</option>
                                                <option value="approved">อนุมัติหัวข้อ</option>
                                                <option value="topic_exam">สอบหัวข้อ</option>
                                                <option value="topic_passed">ผ่านสอบหัวข้อ</option>
                                                <option value="in_progress">กำลังดำเนินการ</option>
                                                <option value="final_exam">สอบจบ</option>
                                                <option value="completed">เสร็จสิ้น</option>
                                                <option value="failed">ไม่ผ่าน</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <select class="form-select" id="typeFilter">
                                                <option value="">ประเภททั้งหมด</option>
                                                <option value="special">โครงงานพิเศษ</option>
                                                <option value="coop">สหกิจศึกษา</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <select class="form-select" id="yearFilter">
                                                <option value="">ปีการศึกษาทั้งหมด</option>
                                                <option value="2567">2567</option>
                                                <option value="2568">2568</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <button class="btn btn-outline-secondary w-100" onclick="clearFilters()">
                                                <i class="fa-solid fa-refresh me-1"></i>รีเซ็ต
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Status Filter Tabs -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="d-flex gap-2 flex-wrap">
                                <button class="btn btn-outline-primary active" onclick="filterByStatus('')">
                                    ทั้งหมด <span class="badge bg-primary ms-2" id="totalCount">0</span>
                                </button>
                                <button class="btn btn-outline-warning" onclick="filterByStatus('proposed')">
                                    เสนอหัวข้อ <span class="badge bg-warning ms-2" id="proposedCount">0</span>
                                </button>
                                <button class="btn btn-outline-info" onclick="filterByStatus('approved')">
                                    อนุมัติหัวข้อ <span class="badge bg-info ms-2" id="approvedCount">0</span>
                                </button>
                                <button class="btn btn-outline-secondary" onclick="filterByStatus('topic_exam')">
                                    สอบหัวข้อ <span class="badge bg-secondary ms-2" id="topicExamCount">0</span>
                                </button>
                                <button class="btn btn-outline-success" onclick="filterByStatus('topic_passed')">
                                    ผ่านสอบหัวข้อ <span class="badge bg-success ms-2" id="topicPassedCount">0</span>
                                </button>
                                <button class="btn btn-outline-primary" onclick="filterByStatus('in_progress')">
                                    กำลังดำเนินการ <span class="badge bg-primary ms-2" id="inProgressCount">0</span>
                                </button>
                                <button class="btn btn-outline-danger" onclick="filterByStatus('final_exam')">
                                    สอบจบ <span class="badge bg-danger ms-2" id="finalExamCount">0</span>
                                </button>
                                <button class="btn btn-outline-success" onclick="filterByStatus('completed')">
                                    เสร็จสิ้น <span class="badge bg-success ms-2" id="completedCount">0</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Projects Grid -->
                    <div class="row g-4" id="projectsGrid">
                        <!-- Project cards will be dynamically generated here -->
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Add Project Modal -->
    <div class="modal fade" id="addProjectModal" tabindex="-1" aria-labelledby="addProjectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addProjectModalLabel">เพิ่มโครงงานใหม่</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addProjectForm">
                        <div class="row g-3">
                            <!-- Project Type -->
                            <div class="col-md-6">
                                <label for="projectType" class="form-label">ประเภทโครงงาน <span class="text-danger">*</span></label>
                                <select class="form-select" id="projectType" required>
                                    <option value="">เลือกประเภทโครงงาน</option>
                                    <option value="special">โครงงานพิเศษ</option>
                                    <option value="coop">สหกิจศึกษา</option>
                                </select>
                            </div>
                            
                            <!-- Academic Year -->
                            <div class="col-md-6">
                                <label for="academicYear" class="form-label">ปีการศึกษา <span class="text-danger">*</span></label>
                                <select class="form-select" id="academicYear" required>
                                    <option value="">เลือกปีการศึกษา</option>
                                    <option value="2567">2567</option>
                                    <option value="2568">2568</option>
                                </select>
                            </div>

                            <!-- Project Title Thai -->
                            <div class="col-12">
                                <label for="projectTitleThai" class="form-label">ชื่อโครงงาน (ภาษาไทย) <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="projectTitleThai" placeholder="ระบุชื่อโครงงานเป็นภาษาไทย" required>
                            </div>

                            <!-- Project Title English -->
                            <div class="col-12">
                                <label for="projectTitleEnglish" class="form-label">ชื่อโครงงาน (ภาษาอังกฤษ)</label>
                                <input type="text" class="form-control" id="projectTitleEnglish" placeholder="Project Title in English">
                            </div>

                            <!-- Project Description -->
                            <div class="col-12">
                                <label for="projectDescription" class="form-label">รายละเอียดโครงงาน <span class="text-danger">*</span></label>
                                <textarea class="form-control" id="projectDescription" rows="4" placeholder="อธิบายรายละเอียดของโครงงาน" required></textarea>
                            </div>

                            <!-- Students Section -->
                            <div class="col-12">
                                <h6 class="mb-3">ข้อมูลนักศึกษา <span class="text-danger">*</span></h6>
                                <div id="studentsContainer">
                                    <div class="student-row mb-3 p-3 border rounded">
                                        <div class="row g-3">
                                            <div class="col-md-4">
                                                <label class="form-label">รหัสนักศึกษา</label>
                                                <input type="text" class="form-control student-id" placeholder="รหัสนักศึกษา" required>
                                            </div>
                                            <div class="col-md-4">
                                                <label class="form-label">ชื่อ-นามสกุล</label>
                                                <input type="text" class="form-control student-name" placeholder="ชื่อ-นามสกุล" required>
                                            </div>
                                            <div class="col-md-4">
                                                <label class="form-label">สาขา</label>
                                                <select class="form-select student-major">
                                                    <option value="">เลือกสาขา</option>
                                                    <option value="IT">เทคโนโลยีสารสนเทศ (IT)</option>
                                                    <option value="ITI">เทคโนโลยีสารสนเทศและนวัตกรรม (ITI)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="addStudent()">
                                    <i class="fa-solid fa-plus me-1"></i>เพิ่มนักศึกษา
                                </button>
                            </div>

                            <!-- Advisor Section -->
                            <div class="col-md-6">
                                <label for="mainAdvisor" class="form-label">อาจารย์ที่ปรึกษาหลัก <span class="text-danger">*</span></label>
                                <select class="form-select" id="mainAdvisor" required>
                                    <option value="">เลือกอาจารย์ที่ปรึกษาหลัก</option>
                                    <option value="advisor1">รศ.ดร.อนิราช มิ่งขวัญ</option>
                                    <option value="advisor2">ผศ.ดร.นิติการ นาคเจือทอง</option>
                                    <option value="advisor3">อ.ดร.วัชรชัย คงศิริวัฒนา</option>
                                </select>
                            </div>

                            <!-- Co-Advisor Section -->
                            <div class="col-md-6">
                                <label for="coAdvisor" class="form-label">อาจารย์ที่ปรึกษาร่วม</label>
                                <select class="form-select" id="coAdvisor">
                                    <option value="">เลือกอาจารย์ที่ปรึกษาร่วม (ไม่บังคับ)</option>
                                    <option value="coadvisor1">ผศ.สมชัย เชียงพงศ์พันธุ์</option>
                                    <option value="coadvisor2">ผศ.ดร.บีสุดา ดาวเรือง</option>
                                </select>
                            </div>

                            <!-- Organization (for Co-op) -->
                            <div class="col-12" id="organizationSection" style="display: none;">
                                <label for="organization" class="form-label">องค์กรสหกิจศึกษา</label>
                                <select class="form-select" id="organization">
                                    <option value="">เลือกองค์กร</option>
                                    <option value="org1">บริษัท เทคโนโลยี จำกัด</option>
                                    <option value="org2">บริษัท ซอฟต์แวร์ จำกัด</option>
                                </select>
                            </div>

                            <!-- Project Duration -->
                            <div class="col-md-6">
                                <label for="startDate" class="form-label">วันที่เริ่มต้น <span class="text-danger">*</span></label>
                                <input type="date" class="form-control" id="startDate" required>
                            </div>
                            <div class="col-md-6">
                                <label for="endDate" class="form-label">วันที่สิ้นสุด <span class="text-danger">*</span></label>
                                <input type="date" class="form-control" id="endDate" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ยกเลิก</button>
                    <button type="button" class="btn btn-primary" onclick="submitProject()">บันทึกโครงงาน</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Detail Modal -->
    <div class="modal fade" id="projectDetailModal" tabindex="-1" aria-labelledby="projectDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="projectDetailModalLabel">รายละเอียดโครงงาน</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <div id="projectDetailContent">
                                <!-- Project details will be loaded here -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">การดำเนินการ</h6>
                                </div>
                                <div class="card-body">
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-outline-primary btn-sm" onclick="viewProgress()">
                                            <i class="fa-solid fa-chart-line me-1"></i>ดูความก้าวหน้า
                                        </button>
                                        <button class="btn btn-outline-info btn-sm" onclick="manageExamination()">
                                            <i class="fa-solid fa-graduation-cap me-1"></i>จัดการการสอบ
                                        </button>
                                        <button class="btn btn-outline-warning btn-sm" onclick="editProject()">
                                            <i class="fa-solid fa-edit me-1"></i>แก้ไขข้อมูล
                                        </button>
                                        <button class="btn btn-outline-danger btn-sm" onclick="deleteProject()">
                                            <i class="fa-solid fa-trash me-1"></i>ลบโครงงาน
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./js/project-management.js"></script>
</body>
</html>
